# Current UI + Feature Mindmap (End-to-End)

This is a "what exists today" mindmap of the UI and feature flows, traced from user actions all the way to the bytes returned (HTML/JSON/Markdown/downloads/files).

```mermaid
mindmap
  root(("Amber Docs (Static Export)"))
    "Global Frame"
      "Site Header"
        "Navigation"
          "Documents"
          "Reading lists"
          "Write + publish (Studio)"
          "Ask AI (Gemini)"
          "Templates"
          "Reusable text"
          "Help"
        "Search Bar (always visible)"
          "Submits to /docs?q=..."
          "Reader-friendly copy + big target button"
      "Site Footer"
        "Page shortcuts"
        "Advanced exports links"
    "Reading (Reader UI)"
      "Home (/)"
        "Start here checklist"
          "Search"
          "Bookmark"
          "Compare versions"
          "Templates + reusable text"
        "Recently updated docs"
          "Links to /docs/[slug]"
        "Reading lists preview"
          "Links to /paths/[pathSlug]"
        "Advanced exports (details)"
          "docs.json"
          "search-index.json"
          "chunks.json"
          "updates.json"
      "Documents Library (/docs)"
        "Client search"
          "Loads /search-index.json (static)"
          "Fuse.js fuzzy search"
          "Synonyms expansion via /synonyms.json"
        "Filters"
          "Stage (draft/final/official)"
          "Topic"
          "Reading list"
          "Bookmarked only (local)"
        "Local-only features"
          "Bookmarks (localStorage)"
          "Saved searches (localStorage)"
        "Output"
          "HTML page"
          "Links to doc detail pages"
      "Doc Detail (/docs/[slug], /docs/[slug]/v/[version])"
        "Version selector"
          "Latest alias vs pinned versions"
        "Governance metadata"
          "Stage chips"
          "Updated + reviewed + owners"
          "Visibility (public/internal/private)"
          "Approvals + citations"
          "Audit log (advanced)"
        "Reader tools"
          "Table of contents"
          "Copy markdown"
          "View markdown (raw route)"
          "Compare versions (diff)"
          "Bookmarks + notes + feedback (local)"
        "Reading list navigation"
          "Prev/Next within collection"
        "AI helper prompts"
          "Copyable prompts for rewrites/claims/contradictions"
        "Output"
          "HTML page"
          "Links to /raw/* and /docs/*/diff"
      "Compare Versions (/docs/[slug]/diff)"
        "Diff UI"
          "Pick two versions"
          "Added/removed highlighting"
        "Output"
          "HTML page"
    "Writing (Writer UI)"
      "Write + Publish (Studio) (/studio)"
        "Step 1: Connect content/docs"
          "Browser File System Access API (Chrome/Edge)"
          "Scan local markdown files"
        "Draft import bridge"
          "Receive draft from Ask AI/Templates (localStorage)"
          "Load into Step 2 automatically"
        "Step 2: Create a doc file"
          "Doc type scaffold (General/Runbook/Policy/FAQ)"
          "Lifecycle defaults"
            "New docs start unpublished (archived=true)"
            "Visibility default: internal"
          "Advanced: Initial content"
            "Paste/import draft body"
            "Optional citations/approvals preserved when imported"
          "Output"
            "Writes new .md/.mdx file to disk"
        "Step 3: Publish/edit existing"
          "Publish/unpublish"
            "Toggle archived boolean"
          "Finalize/Official"
            "Stage transitions"
            "lastReviewedAt for official"
          "Edit markdown + frontmatter"
            "Owners/topics/collection/order"
            "Visibility"
            "Citations + approvals editor"
          "Clone version"
            "New file name for new version"
          "Delete file"
            "Removes file from disk"
        "Output"
          "File writes via FS Access API"
      "Templates (/templates)"
        "Pick template + fill fields"
          "Build prompt pack"
          "Build markdown scaffold"
        "Optional: Generate via Gemini"
          "Key stored locally"
          "Returns Markdown"
        "Send to Studio"
          "Saves draft to localStorage"
          "Redirects to /studio#import"
        "Output"
          "Copy/download text"
          "Draft handoff to Studio"
      "Ask AI (/assistant)"
        "Gemini key + model stored locally"
        "Optional context"
          "Loads /chunks.json excerpts"
          "Light retrieval by token match"
        "Optional blocks"
          "Glossary + disclaimers"
        "Generate"
          "Calls Gemini from browser"
        "Send to Studio"
          "Saves full doc (frontmatter+markdown) to localStorage"
          "Redirects to /studio#import"
        "Output"
          "Copy/download text"
          "Draft handoff to Studio"
      "Reusable Text (/blocks)"
        "Disclaimers + glossary"
          "From content/blocks/*.json"
        "Custom local blocks"
          "Saved locally in browser"
        "Output"
          "Copy blocks text"
    "Content System (Build-Time Data Path)"
      "Source of truth"
        "content/docs/*.md(x)"
        "content/templates/*"
        "content/blocks/*"
      "Doc parsing"
        "gray-matter frontmatter"
        "Derived"
          "TOC + headings"
          "Search text"
          "Content hash"
      "Lifecycle + governance model"
        "archived"
          "unpublished (hidden)"
        "stage"
          "draft | final | official"
        "visibility"
          "public | internal | private"
        "audit log"
          "create/clone/update/publish/unpublish/stage change"
      "Audience + public export"
        "AMBER_DOCS_AUDIENCE"
          "public/internal/private (build-time)"
        "AMBER_DOCS_PUBLIC_EXPORT=1"
          "Only Official + Public visibility"
        "Audience redaction blocks"
          "<!-- audience:internal:start --> ... end"
          "<!-- audience:private:start --> ... end"
    "Outputs (What Users/Integrations Receive)"
      "HTML"
        "Next.js pages (static export)"
      "Markdown"
        "/raw/[slug]"
          "Latest visible version"
          "ETag + Last-Modified + 304 support"
        "/raw/v/[slug]/[version]"
          "Pinned version"
          "ETag + Last-Modified + 304 support"
      "JSON"
        "/docs.json"
          "All versions + latest alias per slug"
          "ETag + Last-Modified + 304 support"
        "/search-index.json"
          "Search payload for /docs"
        "/chunks.json"
          "Chunked export for RAG"
        "/updates.json"
          "Build ID + content hashes"
        "/synonyms.json"
          "Search synonyms"
        "/claims.json"
          "Numbers/dates heuristic extraction"
        "/embeddings-manifest.json"
          "Chunk hashes by doc/section"
    "Quality Gates"
      "Content QA (pnpm qa)"
        "Frontmatter validity"
        "Duplicate versions"
        "Broken internal links"
        "Missing assets"
        "Official requirements"
          "Owners/topics/review date"
          "Citations + approvals"
          "Optional canonical facts contradiction scan"
      "Tests (pnpm test / pnpm coverage)"
        "Server helpers"
        "Route handlers"
        "Workflow scripts"
      "Build budgets (pnpm perf:budget)"
        "Max sizes for key exported JSON"
        "Total out/ size budget"
```

